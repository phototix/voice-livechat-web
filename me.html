<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>壹韶APP - 我的</title>
    <script>
        var script = document.createElement('script');
        script.type = 'text/javascript';
        script.src = 'script/app.js?version=' + new Date().getTime();
        document.head.appendChild(script);
    </script>
    <script>
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = 'assets/css/me.css?version=' + new Date().getTime();
        document.head.appendChild(link);
    </script>
</head>
<body>
    <div class="header" style="background: linear-gradient(to bottom, rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.6)), 
                url('assets/yishao-profile.jpg') no-repeat center center;">
        <img src="assets/yishao-profile.jpg" class="avatar" alt="User Avatar">
    </div>
    <div class="user-info">
        <h1>壹韶</h1>
        <p>ID: 96844131</p>
        <div class="badges">
            <div class="badge vip">VIP</div>
            <div class="badge special">贵族特权</div>
            <div class="badge rank">至尊帝王</div>
        </div>
    </div>
    <div class="stats">
        <div class="stat">
            <span>0</span>
            好友
        </div>
        <div class="stat">
            <span>1</span>
            关注
        </div>
        <div class="stat">
            <span>1</span>
            粉丝
        </div>
        <div class="stat">
            <span>1</span>
            收藏
        </div>
    </div>

    <div class="additional-info">
        <div class="vip-status">
            <h2>至尊帝王</h2>
            <div class="vip-badge">贵族特权 <span>V</span></div>
        </div>
        <div class="balance">
            <div>
                <span>0.00</span>
                <p>去充值</p>
            </div>
            <div>
                <span>0.00</span>
                <p>去兑换</p>
            </div>
        </div>
        <ul class="settings">
            <li><a href="#level">我的等级</a></li>
            <li><a href="#privacy">隐私设置</a></li>
            <li><a href="#guild">我的公会</a></li>
            <li><a href="#youth-mode">青少年模式</a></li>
            <li><a href="#logout" onclick="handleLogout();" style="color:red;">登出</a></li>
        </ul>
    </div>


    <!-- Navbar -->
    <div class="navbar">
        <a href="explore.html"><img src="assets/apps/app-01.png" alt="航行"><br>航行</a>
        <a href="/"><img src="assets/apps/app-02.png" alt="派對"><br>派對</a>
        <a href="chat.html"><img src="assets/apps/app-03.png" alt="訊息"><br>訊息</a>
        <a href="#" class="active"><img src="assets/apps/app-04.png" alt="我的"><br>我的</a>
    </div>

    <script>
    document.addEventListener("DOMContentLoaded", function () {
        // Fetch the user ID from the cookie
        const cookies = document.cookie.split('; ').reduce((acc, curr) => {
            const [key, value] = curr.split('=');
            acc[key] = value;
            return acc;
        }, {});
        const userID = cookies.userLoggedIn;

        // Fetch the JSON file for the user
        fetch(`cache/${userID}-user.json`)
            .then(response => response.json())
            .then(data => {
                // Populate the HTML
                document.querySelector(".header").style.backgroundImage = `linear-gradient(to bottom, rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.6)), 
                    url('${data.profileImageURL}')`;

                document.querySelector(".avatar").src = data.profileImageURL;
                document.querySelector(".avatar").alt = `${data.name} Avatar`;

                document.querySelector(".user-info h1").textContent = data.name;
                document.querySelector(".user-info p").textContent = `ID: ${data.userID}`;

                const badgesContainer = document.querySelector(".badges");
                badgesContainer.innerHTML = `
                    <div class="badge vip">${data.vip}</div>
                    <div class="badge special">${data.special}</div>
                    <div class="badge rank">${data.rank}</div>
                `;

                document.querySelectorAll(".stat span")[0].textContent = data.friends;
                document.querySelectorAll(".stat span")[1].textContent = data.follows;
                document.querySelectorAll(".stat span")[2].textContent = data.fans;
                document.querySelectorAll(".stat span")[3].textContent = data.saved;

                document.querySelector(".vip-status h2").textContent = data.rank;
                document.querySelector(".vip-badge").innerHTML = `${data.special} <span>V</span>`;

                const balanceElements = document.querySelectorAll(".balance div span");
                balanceElements[0].textContent = data.balance;
                balanceElements[1].textContent = data.balance;
            })
            .catch(err => console.error("Error loading user data:", err));
    });
    </script>

</body>
</html>
